{"dataflow":{"dfKey":"4eac3edd-a384-4787-9a2d-0b71ffe2d544","name":"AWS_Iceberg","tags":null,"description":null,"definition":"{\"name\":\"AWS_Iceberg\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"code\":\"from pyspark.sql import SparkSession\\r\\n\\r\\nspark \\u003d SparkSession.builder \\\\\\r\\n    .appName(\\\"Iceberg Read Example\\\") \\\\\\r\\n    .config(\\\"spark.jars\\\", \\\",\\\".join([\\r\\n        \\\"/opt/datagaps/DataOpsEngine/livy/rsc-jars/iceberg-spark-runtime-3.5_2.12-1.5.0.jar\\\",\\r\\n        \\\"/opt/datagaps/DataOpsEngine/livy/rsc-jars/hadoop-aws-3.3.4.jar\\\",\\r\\n        \\\"/opt/datagaps/DataOpsEngine/livy/rsc-jars/aws-java-sdk-bundle-1.12.215.jar\\\"\\r\\n    ])) \\\\\\r\\n    .config(\\\"spark.sql.catalog.hadoop_cat\\\", \\\"org.apache.iceberg.spark.SparkCatalog\\\") \\\\\\r\\n    .config(\\\"spark.sql.catalog.hadoop_cat.catalog-impl\\\", \\\"org.apache.iceberg.hadoop.HadoopCatalog\\\") \\\\\\r\\n    .config(\\\"spark.sql.catalog.hadoop_cat.warehouse\\\", \\\"s3a://iceberg-warehouse\\\") \\\\\\r\\n    .config(\\\"spark.sql.catalog.hadoop_cat.io-impl\\\", \\\"org.apache.iceberg.aws.s3.S3FileIO\\\") \\\\\\r\\n    .config(\\\"spark.hadoop.fs.s3a.access.key\\\", \\\"AKIAV5DLRL43YLKZ7EX2 \\\") \\\\\\r\\n    .config(\\\"spark.hadoop.fs.s3a.secret.key\\\", \\\"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\\\") \\\\\\r\\n    .config(\\\"spark.hadoop.fs.s3a.endpoint\\\", \\\"http://192.168.6.91:9001//\\\") \\\\\\r\\n    .config(\\\"spark.hadoop.fs.s3a.connection.ssl.enabled\\\", \\\"false\\\") \\\\\\r\\n    .config(\\\"spark.hadoop.fs.s3a.impl\\\", \\\"org.apache.hadoop.fs.s3a.S3AFileSystem\\\") \\\\\\r\\n    .getOrCreate()\\r\\n\\r\\n\\r\\ndf \\u003d spark.read.format(\\\"iceberg\\\").load(\\\"hadoop_cat.dbname.customers\\\")\\r\\ndf.show()\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"hideDatasets\":\"N\",\"componentId\":1,\"componentName\":\"Code 1\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import os\\r\\nprint(os.listdir(\\\"/opt/datagaps/DataOpsEngine/livy/rsc-jars\\\"))\\r\\n\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"hideDatasets\":\"N\",\"componentId\":2,\"componentName\":\"Code 2\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"type\":\"static\",\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":2,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null,"diagramSchema":"{\"isCustom\":false,\"diagramDef\":[]}"},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[],"filterDatasetMappings":[],"referenceDatasets":null}